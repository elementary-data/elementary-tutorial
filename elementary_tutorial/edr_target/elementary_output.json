{"creation_time": "2025-03-20T08:33:46+00:00", "days_back": 7, "models": {"model.elementary_tutorial.returned_orders": {"name": "returned_orders", "unique_id": "model.elementary_tutorial.returned_orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table contains all of the returned orders", "full_path": "models/returned_orders.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "returned_orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "returned_orders", "normalized_full_path": "elementary_tutorial/models/returned_orders.sql", "fqn": "elementary_tutorial.elementary.returned_orders", "artifact_type": "model"}, "model.elementary_tutorial.customers": {"name": "customers", "unique_id": "model.elementary_tutorial.customers", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/customers.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "customers", "normalized_full_path": "elementary_tutorial/models/customers.sql", "fqn": "elementary_tutorial.elementary.customers", "artifact_type": "model"}, "model.elementary_tutorial.orders": {"name": "orders", "unique_id": "model.elementary_tutorial.orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table has basic information about orders, as well as some derived facts based on payments", "full_path": "models/orders.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "orders", "normalized_full_path": "elementary_tutorial/models/orders.sql", "fqn": "elementary_tutorial.elementary.orders", "artifact_type": "model"}, "model.elementary_tutorial.stg_customers": {"name": "stg_customers", "unique_id": "model.elementary_tutorial.stg_customers", "owners": [], "tags": ["PII", "staging"], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_customers.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "stg_customers", "patch_path": "elementary_tutorial://models/staging/schema.yml", "model_name": "stg_customers", "normalized_full_path": "elementary_tutorial/models/staging/stg_customers.sql", "fqn": "elementary_tutorial.elementary.stg_customers", "artifact_type": "model"}, "model.elementary_tutorial.stg_payments": {"name": "stg_payments", "unique_id": "model.elementary_tutorial.stg_payments", "owners": [], "tags": ["finance", "staging"], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_payments.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "stg_payments", "patch_path": "elementary_tutorial://models/staging/schema.yml", "model_name": "stg_payments", "normalized_full_path": "elementary_tutorial/models/staging/stg_payments.sql", "fqn": "elementary_tutorial.elementary.stg_payments", "artifact_type": "model"}, "model.elementary_tutorial.stg_orders": {"name": "stg_orders", "unique_id": "model.elementary_tutorial.stg_orders", "owners": [], "tags": ["finance", "staging"], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_orders.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "stg_orders", "patch_path": "elementary_tutorial://models/staging/schema.yml", "model_name": "stg_orders", "normalized_full_path": "elementary_tutorial/models/staging/stg_orders.sql", "fqn": "elementary_tutorial.elementary.stg_orders", "artifact_type": "model"}, "model.elementary_tutorial.stg_signups": {"name": "stg_signups", "unique_id": "model.elementary_tutorial.stg_signups", "owners": [], "tags": ["PII", "staging"], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_signups.sql", "meta": {}, "materialization": "view", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "stg_signups", "patch_path": "elementary_tutorial://models/staging/schema.yml", "model_name": "stg_signups", "normalized_full_path": "elementary_tutorial/models/staging/stg_signups.sql", "fqn": "elementary_tutorial.elementary.stg_signups", "artifact_type": "model"}, "seed.elementary_tutorial.customers_training": {"name": "customers_training", "unique_id": "seed.elementary_tutorial.customers_training", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/training/customers_training.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers_training", "model_name": "customers_training", "normalized_full_path": "elementary_tutorial/seeds/training/customers_training.csv", "fqn": "elementary_tutorial.elementary.customers_training", "artifact_type": "seed"}, "seed.elementary_tutorial.payments_training": {"name": "payments_training", "unique_id": "seed.elementary_tutorial.payments_training", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/training/payments_training.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "payments_training", "model_name": "payments_training", "normalized_full_path": "elementary_tutorial/seeds/training/payments_training.csv", "fqn": "elementary_tutorial.elementary.payments_training", "artifact_type": "seed"}, "seed.elementary_tutorial.signups_training": {"name": "signups_training", "unique_id": "seed.elementary_tutorial.signups_training", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/training/signups_training.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "signups_training", "model_name": "signups_training", "normalized_full_path": "elementary_tutorial/seeds/training/signups_training.csv", "fqn": "elementary_tutorial.elementary.signups_training", "artifact_type": "seed"}, "seed.elementary_tutorial.orders_training": {"name": "orders_training", "unique_id": "seed.elementary_tutorial.orders_training", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/training/orders_training.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "orders_training", "model_name": "orders_training", "normalized_full_path": "elementary_tutorial/seeds/training/orders_training.csv", "fqn": "elementary_tutorial.elementary.orders_training", "artifact_type": "seed"}, "seed.elementary_tutorial.payments_validation": {"name": "payments_validation", "unique_id": "seed.elementary_tutorial.payments_validation", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/validation/payments_validation.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "payments_validation", "model_name": "payments_validation", "normalized_full_path": "elementary_tutorial/seeds/validation/payments_validation.csv", "fqn": "elementary_tutorial.elementary.payments_validation", "artifact_type": "seed"}, "seed.elementary_tutorial.signups_validation": {"name": "signups_validation", "unique_id": "seed.elementary_tutorial.signups_validation", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/validation/signups_validation.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "signups_validation", "model_name": "signups_validation", "normalized_full_path": "elementary_tutorial/seeds/validation/signups_validation.csv", "fqn": "elementary_tutorial.elementary.signups_validation", "artifact_type": "seed"}, "seed.elementary_tutorial.customers_validation": {"name": "customers_validation", "unique_id": "seed.elementary_tutorial.customers_validation", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/validation/customers_validation.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers_validation", "model_name": "customers_validation", "normalized_full_path": "elementary_tutorial/seeds/validation/customers_validation.csv", "fqn": "elementary_tutorial.elementary.customers_validation", "artifact_type": "seed"}, "seed.elementary_tutorial.orders_validation": {"name": "orders_validation", "unique_id": "seed.elementary_tutorial.orders_validation", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "seeds/validation/orders_validation.csv", "meta": {}, "materialization": null, "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "orders_validation", "model_name": "orders_validation", "normalized_full_path": "elementary_tutorial/seeds/validation/orders_validation.csv", "fqn": "elementary_tutorial.elementary.orders_validation", "artifact_type": "seed"}}, "groups": {"data_assets": [{"name": "dwh", "data": {"elementary_tutorial": {"elementary": {"__files__": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}]}}}}, {"name": "dbt", "data": {"elementary_tutorial": {"models": {"__files__": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}], "staging": {"__files__": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}]}}, "seeds": {"training": {"__files__": [{"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}]}, "validation": {"__files__": [{"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}}}}}, {"name": "tags", "data": {"finance": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}], "PII": [{"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}], "staging": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}], "No tags": [{"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}}, {"name": "owners", "data": {"No owners": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}}], "bi_assets": null, "dbt": {"elementary_tutorial": {"models": {"__files__": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}], "staging": {"__files__": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}]}}, "seeds": {"training": {"__files__": [{"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}]}, "validation": {"__files__": [{"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}}}}, "tags": {"finance": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}], "PII": [{"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}], "staging": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}], "No tags": [{"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}, "owners": {"No owners": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "seed.elementary_tutorial.customers_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_training", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.payments_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.signups_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.customers_validation", "resource_type": "seed"}, {"node_id": "seed.elementary_tutorial.orders_validation", "resource_type": "seed"}]}}, "invocation": {"invocation_id": null, "detected_at": null, "command": null, "selected": null, "full_refresh": null, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}, "tests": {"test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e": {"unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": null, "column_name": null, "name": "elementary_volume_anomalies_returned_orders_order_date", "display_name": "Elementary Volume Anomalies Returned Orders Order Date", "original_path": "models/schema.yml", "type": "generic", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}"}, "description": null, "configuration": {"test_name": "elementary_volume_anomalies_returned_orders_order_date", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "tags": ["finance", "table_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml", "created_at": "2025-03-20T08:32:26", "latest_run_time": "2025-03-20T08:32:26+00:00", "latest_run_time_utc": "2025-03-20T10:32:26+02:00", "latest_run_status": "fail"}, "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381": {"unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": null, "column_name": "number_of_orders", "name": "elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date", "display_name": "Elementary Column Anomalies Customers Zero Count  Number Of Orders  Signup Date", "original_path": "models/schema.yml", "type": "generic", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}"}, "description": null, "configuration": {"test_name": "elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "tags": ["column_anomalies", "PII", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml", "created_at": "2025-03-19T16:59:19.784000", "latest_run_time": "2025-03-20T08:32:25+00:00", "latest_run_time_utc": "2025-03-20T10:32:25+02:00", "latest_run_status": "pass"}, "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c": {"unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": null, "column_name": null, "name": "elementary_volume_anomalies_customers_", "display_name": "Elementary Volume Anomalies Customers ", "original_path": "models/schema.yml", "type": "generic", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_params": {"model": "{{ get_where_subquery(ref('customers')) }}"}, "description": null, "configuration": {"test_name": "elementary_volume_anomalies_customers_", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "tags": ["PII", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml", "created_at": "2025-03-20T08:32:25", "latest_run_time": "2025-03-20T08:32:25+00:00", "latest_run_time_utc": "2025-03-20T10:32:25+02:00", "latest_run_status": "pass"}, "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371": {"unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": null, "column_name": null, "name": "elementary_dimension_anomalies_orders_status", "display_name": "Elementary Dimension Anomalies Orders Status", "original_path": "models/schema.yml", "type": "generic", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "description": null, "configuration": {"test_name": "elementary_dimension_anomalies_orders_status", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "tags": ["finance", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml", "created_at": "2025-03-20T08:32:28", "latest_run_time": "2025-03-20T08:32:28+00:00", "latest_run_time_utc": "2025-03-20T10:32:28+02:00", "latest_run_status": "pass"}}, "test_results": {"model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.NUMBER_OF_ORDERS.zero_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers", "column_name": "NUMBER_OF_ORDERS", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:25+02:00", "latest_run_time_utc": "2025-03-20T08:32:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_tutorial.elementary.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('zero_count' as varchar)\n          and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as varchar))", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.222.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('zero_count' as varchar)\n          and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as varchar))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 1.0, "average": 0.5, "min_value": 0.0, "max_value": 2.621320343559643, "start_time": "2025-03-07T00:00:00", "end_time": "2025-03-08T00:00:00", "id": "1a1a61c0a77f539421fd65c7905c173c", "metric_id": "0bc068f889143d49c56de6556d84e872", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": 0.7071067811865475, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-07T00:00:00", "bucket_end": "2025-03-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 1.0, "min_metric_value": 0.0, "max_metric_value": 2.621320343559643, "training_avg": 0.5, "training_stddev": 0.7071067811865476, "training_set_size": 2, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 1.000. The average for this metric is 0.500.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.3333333333333333, "min_value": 0.0, "max_value": 2.0653841409022107, "start_time": "2025-03-08T00:00:00", "end_time": "2025-03-09T00:00:00", "id": "aa4689a99416c5050fb7ecc12d37bf0c", "metric_id": "4f9662cd66d483f20a816167c9cf44ed", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.5773502691896257, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-08T00:00:00", "bucket_end": "2025-03-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 2.0653841409022107, "training_avg": 0.3333333333333333, "training_stddev": 0.5773502691896257, "training_set_size": 3, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.333.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.25, "min_value": 0.0, "max_value": 1.75, "start_time": "2025-03-09T00:00:00", "end_time": "2025-03-10T00:00:00", "id": "a3a2c6ebeb051b50df8ef1add74cf814", "metric_id": "f8ff7a15e53285d7a91d48c508124cf7", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.5, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-09T00:00:00", "bucket_end": "2025-03-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 1.75, "training_avg": 0.25, "training_stddev": 0.5, "training_set_size": 4, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.250.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.2, "min_value": 0.0, "max_value": 1.5416407864998738, "start_time": "2025-03-10T00:00:00", "end_time": "2025-03-11T00:00:00", "id": "91810947382b1ea42b29bb746e98b09b", "metric_id": "02ca14e55b0376f819786a98b704d1b7", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.447213595499958, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-10T00:00:00", "bucket_end": "2025-03-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 1.5416407864998738, "training_avg": 0.2, "training_stddev": 0.4472135954999579, "training_set_size": 5, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.200.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 1.0, "average": 0.3333333333333333, "min_value": 0.0, "max_value": 1.8825266718162998, "start_time": "2025-03-11T00:00:00", "end_time": "2025-03-12T00:00:00", "id": "0049f185e0a8cd658714084ddf2b0ee9", "metric_id": "6ecb5acbb9a89ec210075716c5e27890", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": 1.2909944487358058, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-11T00:00:00", "bucket_end": "2025-03-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 1.0, "min_metric_value": 0.0, "max_metric_value": 1.8825266718162998, "training_avg": 0.3333333333333333, "training_stddev": 0.5163977794943222, "training_set_size": 6, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 1.000. The average for this metric is 0.333.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.2857142857142857, "min_value": 0.0, "max_value": 1.7495643951370856, "start_time": "2025-03-12T00:00:00", "end_time": "2025-03-13T00:00:00", "id": "5f5e77c9ab65386f04e3708bfaf8d17b", "metric_id": "ab2551a3e1f7eb0736f18aaf1535a306", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.5855400437691198, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-12T00:00:00", "bucket_end": "2025-03-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 1.7495643951370856, "training_avg": 0.2857142857142857, "training_stddev": 0.4879500364742666, "training_set_size": 7, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.286.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.25, "min_value": 0.0, "max_value": 1.6387301496588271, "start_time": "2025-03-13T00:00:00", "end_time": "2025-03-14T00:00:00", "id": "f512fe3a90c924a5bb8e0a326750437b", "metric_id": "36ded5bfa1c1056e6c44d79c84666b0d", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.5400617248673217, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-13T00:00:00", "bucket_end": "2025-03-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 1.6387301496588271, "training_avg": 0.25, "training_stddev": 0.4629100498862757, "training_set_size": 8, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.250.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.2222222222222222, "min_value": 0.0, "max_value": 1.5450978777545177, "start_time": "2025-03-15T00:00:00", "end_time": "2025-03-16T00:00:00", "id": "570af9c799f5efef7b0f86624135e671", "metric_id": "c43eba66208361ba05d554628ff126da", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "detected_at": "2025-03-20T08:32:24.878000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": "NUMBER_OF_ORDERS", "metric_name": "zero_count", "anomaly_score": -0.5039526306789696, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-15T00:00:00", "bucket_end": "2025-03-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 1.5450978777545177, "training_avg": 0.2222222222222222, "training_stddev": 0.44095855184409843, "training_set_size": 9, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.222.", "max_bucket_end": "2025-03-16T00:00:00", "is_anomalous": false}], "result_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.222."}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c.None.row_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:25+02:00", "latest_run_time_utc": "2025-03-20T08:32:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_tutorial.elementary.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)", "test_params": {"model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 14.500.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 56.0, "average": 56.5, "min_value": 54.378679656440355, "max_value": 58.621320343559645, "start_time": "2025-03-07T00:00:00", "end_time": "2025-03-08T00:00:00", "id": "64bf2b693fe21aac4a7edf309e3970f4", "metric_id": "4147231b5c58cd3babcf80fc5caf3b50", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.7071067811865475, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-07T00:00:00", "bucket_end": "2025-03-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 56.0, "min_metric_value": 54.378679656440355, "max_metric_value": 58.621320343559645, "training_avg": 56.5, "training_stddev": 0.7071067811865476, "training_set_size": 2, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 56.000. The average for this metric is 56.500.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 19.0, "average": 44.0, "min_value": 0.0, "max_value": 108.96922348312314, "start_time": "2025-03-08T00:00:00", "end_time": "2025-03-09T00:00:00", "id": "acf14b990450813eef4fed9363a781af", "metric_id": "8851d451858d81c1fd2490c670ff9f67", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.1543927413490254, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-08T00:00:00", "bucket_end": "2025-03-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 19.0, "min_metric_value": 0.0, "max_metric_value": 108.96922348312314, "training_avg": 44.0, "training_stddev": 21.656407827707714, "training_set_size": 3, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 19.000. The average for this metric is 44.000.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 33.0, "average": 41.25, "min_value": 0.0, "max_value": 96.80402775677027, "start_time": "2025-03-09T00:00:00", "end_time": "2025-03-10T00:00:00", "id": "90f5c826e87691c57eb691efe4dba6dc", "metric_id": "40f3f53edaf8acefccd8ef1e95b37070", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.44551225175538717, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-09T00:00:00", "bucket_end": "2025-03-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 33.0, "min_metric_value": 0.0, "max_metric_value": 96.80402775677027, "training_avg": 41.25, "training_stddev": 18.518009252256753, "training_set_size": 4, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 33.000. The average for this metric is 41.250.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 12.0, "average": 35.4, "min_value": 0.0, "max_value": 97.48623035746331, "start_time": "2025-03-10T00:00:00", "end_time": "2025-03-11T00:00:00", "id": "a3670e0f44864e0542e87a95e2560b3f", "metric_id": "2ce1486077b63bd164cd867f76a7f81a", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.1306854933182673, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-10T00:00:00", "bucket_end": "2025-03-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 12.0, "min_metric_value": 0.0, "max_metric_value": 97.48623035746331, "training_avg": 35.4, "training_stddev": 20.69541011915444, "training_set_size": 5, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 12.000. The average for this metric is 35.400.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 13.0, "average": 31.666666666666668, "min_value": 0.0, "max_value": 93.60534601971713, "start_time": "2025-03-11T00:00:00", "end_time": "2025-03-12T00:00:00", "id": "1c7dc4426e6381403c7635ce5f665ecf", "metric_id": "7c429ad7d0eda214aa9d0e28c97c1f9d", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.904120019750502, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-11T00:00:00", "bucket_end": "2025-03-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 13.0, "min_metric_value": 0.0, "max_metric_value": 93.60534601971713, "training_avg": 31.666666666666668, "training_stddev": 20.646226451016823, "training_set_size": 6, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 13.000. The average for this metric is 31.667.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 8.0, "average": 28.285714285714285, "min_value": 0.0, "max_value": 90.87279647639367, "start_time": "2025-03-12T00:00:00", "end_time": "2025-03-13T00:00:00", "id": "c953332e25c28b22f1fa669ab18cae0a", "metric_id": "c9f562384f21c494e56096c748400ed4", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.9723594826123055, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-12T00:00:00", "bucket_end": "2025-03-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 8.0, "min_metric_value": 0.0, "max_metric_value": 90.87279647639367, "training_avg": 28.285714285714285, "training_stddev": 20.862360730226463, "training_set_size": 7, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 8.000. The average for this metric is 28.286.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 4.0, "average": 25.25, "min_value": 0.0, "max_value": 88.66191866338242, "start_time": "2025-03-13T00:00:00", "end_time": "2025-03-14T00:00:00", "id": "ad464271c29439d833dfa4b629444b56", "metric_id": "bc8e7986179c86c13c525818104fb230", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.0053315109169343, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-13T00:00:00", "bucket_end": "2025-03-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 4.0, "min_metric_value": 0.0, "max_metric_value": 88.66191866338242, "training_avg": 25.25, "training_stddev": 21.137306221127474, "training_set_size": 8, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 4.000. The average for this metric is 25.250.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 22.444444444444443, "min_value": 0.0, "max_value": 86.91149028958924, "start_time": "2025-03-14T00:00:00", "end_time": "2025-03-15T00:00:00", "id": "a5e3148bc465dcdf1fcad4d1472e9e7d", "metric_id": "b4cc659fc69d88aabd08763e3b91049c", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.044461281738791, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-14T00:00:00", "bucket_end": "2025-03-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 86.91149028958924, "training_avg": 22.444444444444443, "training_stddev": 21.48901528171493, "training_set_size": 9, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 22.444.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 1.0, "average": 20.3, "min_value": 0.0, "max_value": 84.3944615392001, "start_time": "2025-03-15T00:00:00", "end_time": "2025-03-16T00:00:00", "id": "9dec89ea97663368126e16016e7e6b6e", "metric_id": "ccf078a00bf0d9b5372bb85bed78126b", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.9033541839584445, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-15T00:00:00", "bucket_end": "2025-03-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 1.0, "min_metric_value": 0.0, "max_metric_value": 84.3944615392001, "training_avg": 20.3, "training_stddev": 21.364820513066697, "training_set_size": 10, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 1.000. The average for this metric is 20.300.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 18.454545454545453, "min_value": 0.0, "max_value": 81.9719017082069, "start_time": "2025-03-16T00:00:00", "end_time": "2025-03-17T00:00:00", "id": "014f24db822fdb49a66542a88e1a4df1", "metric_id": "d1713680573cfdbdf3999fd72c4d1b8f", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.8716300493134099, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-16T00:00:00", "bucket_end": "2025-03-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 81.9719017082069, "training_avg": 18.454545454545453, "training_stddev": 21.172452084553818, "training_set_size": 11, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 18.455.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 16.916666666666668, "min_value": 0.0, "max_value": 79.55143046732003, "start_time": "2025-03-17T00:00:00", "end_time": "2025-03-18T00:00:00", "id": "cb33ee72ad62aaec9b602eea4e0dc410", "metric_id": "b50433323a8cc60f136c70283c1fa142", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.8102529158012186, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-17T00:00:00", "bucket_end": "2025-03-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 79.55143046732003, "training_avg": 16.916666666666668, "training_stddev": 20.878254600217787, "training_set_size": 12, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 16.917.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 15.615384615384615, "min_value": 0.0, "max_value": 77.21333662929246, "start_time": "2025-03-18T00:00:00", "end_time": "2025-03-19T00:00:00", "id": "374d358e4df870acad70ae6577468686", "metric_id": "490e3891204b3d9f882d8868b360c249", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.7605147949655328, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-18T00:00:00", "bucket_end": "2025-03-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 77.21333662929246, "training_avg": 15.615384615384615, "training_stddev": 20.532650671302612, "training_set_size": 13, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 15.615.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 14.5, "min_value": 0.0, "max_value": 74.99125810968316, "start_time": "2025-03-19T00:00:00", "end_time": "2025-03-20T00:00:00", "id": "f54b6d1f69c7d6462f8ca4a35aa6f4b7", "metric_id": "67887121591ea8dee53e4917c40f8a35", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "detected_at": "2025-03-20T08:32:25.235000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.7191121718964004, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-19T00:00:00", "bucket_end": "2025-03-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 74.99125810968316, "training_avg": 14.5, "training_stddev": 20.16375270322772, "training_set_size": 14, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 14.500.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 14.500."}}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:28+02:00", "latest_run_time_utc": "2025-03-20T08:32:28+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "elementary_tutorial.elementary.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from ELEMENTARY_TUTORIAL.ELEMENTARY__tests.\"test_a5036d4371_elementary_dimension_anomalies_orders_status__anomaly_scores__tmp_20250320083224730804\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    dateadd(day, cast('-2' as integer), cast(max_bucket_end as timestamp))\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from ELEMENTARY_TUTORIAL.ELEMENTARY__tests.\"test_a5036d4371_elementary_dimension_anomalies_orders_status__anomaly_scores__tmp_20250320083224730804\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    dateadd(day, cast('-2' as integer), cast(max_bucket_end as timestamp))\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": {"headers": [{"id": "anomalous_value_timestamp", "display_name": "timestamp", "type": "date"}, {"id": "anomalous_value_generic", "display_name": "generic", "type": "int"}, {"id": "anomalous_value_average_generic", "display_name": "average generic", "type": "int"}], "test_rows_sample": []}, "result_description": null}}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:26+02:00", "latest_run_time_utc": "2025-03-20T08:32:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_tutorial.elementary.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 39.643.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 42.0, "average": 41.5, "min_value": 39.378679656440355, "max_value": 43.621320343559645, "start_time": "2025-03-07T00:00:00", "end_time": "2025-03-08T00:00:00", "id": "77891637a3e56f8888acb913f0456eff", "metric_id": "bcb929f2e0b350e734584b2adef15cd6", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.7071067811865475, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-07T00:00:00", "bucket_end": "2025-03-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 42.0, "min_metric_value": 39.378679656440355, "max_metric_value": 43.621320343559645, "training_avg": 41.5, "training_stddev": 0.7071067811865476, "training_set_size": 2, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 42.000. The average for this metric is 41.500.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 44.0, "average": 42.333333333333336, "min_value": 37.75075763837749, "max_value": 46.91590902828918, "start_time": "2025-03-08T00:00:00", "end_time": "2025-03-09T00:00:00", "id": "9207f38cd18439b04c88ebb6413dea9f", "metric_id": "19e60c2c8aae163c7e97f56a4504e192", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 1.0910894511799603, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-08T00:00:00", "bucket_end": "2025-03-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 44.0, "min_metric_value": 37.75075763837749, "max_metric_value": 46.91590902828918, "training_avg": 42.333333333333336, "training_stddev": 1.5275252316519468, "training_set_size": 3, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 44.000. The average for this metric is 42.333.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 48.0, "average": 43.75, "min_value": 34.46291218949665, "max_value": 53.03708781050335, "start_time": "2025-03-09T00:00:00", "end_time": "2025-03-10T00:00:00", "id": "2b89a71905a2842ec32ee86fef5e9ed3", "metric_id": "dc2dd73576110510ad7d05a4225381a0", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 1.372873850248322, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-09T00:00:00", "bucket_end": "2025-03-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 48.0, "min_metric_value": 34.46291218949665, "max_metric_value": 53.03708781050335, "training_avg": 43.75, "training_stddev": 3.095695936834452, "training_set_size": 4, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 48.000. The average for this metric is 43.750.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 39.0, "average": 42.8, "min_value": 32.538421174107754, "max_value": 53.06157882589224, "start_time": "2025-03-10T00:00:00", "end_time": "2025-03-11T00:00:00", "id": "a7765394ae6be50365545f0638128aed", "metric_id": "54c79b8df71c69439ceea005dd207e70", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.1109401577889029, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-10T00:00:00", "bucket_end": "2025-03-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 39.0, "min_metric_value": 32.538421174107754, "max_metric_value": 53.06157882589224, "training_avg": 42.8, "training_stddev": 3.420526275297414, "training_set_size": 5, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 39.000. The average for this metric is 42.800.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 46.0, "average": 43.333333333333336, "min_value": 33.35335337343362, "max_value": 53.31331329323305, "start_time": "2025-03-11T00:00:00", "end_time": "2025-03-12T00:00:00", "id": "34f5024a71b4cabee5690089b9ddfc4e", "metric_id": "c99ad057cf6ffd6854e9fe49fe13ca85", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.8016048160562016, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-11T00:00:00", "bucket_end": "2025-03-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 46.0, "min_metric_value": 33.35335337343362, "max_metric_value": 53.31331329323305, "training_avg": 43.333333333333336, "training_stddev": 3.32665998663324, "training_set_size": 6, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 46.000. The average for this metric is 43.333.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 45.0, "average": 43.57142857142857, "min_value": 34.26705172118069, "max_value": 52.875805421676446, "start_time": "2025-03-12T00:00:00", "end_time": "2025-03-13T00:00:00", "id": "7b7cd93291d5f148c008ad9904849fd9", "metric_id": "e04d596fb2ef32288deff63491fc0b75", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.4606127153588064, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-12T00:00:00", "bucket_end": "2025-03-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 45.0, "min_metric_value": 34.26705172118069, "max_metric_value": 52.875805421676446, "training_avg": 43.57142857142857, "training_stddev": 3.101458950082625, "training_set_size": 7, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 45.000. The average for this metric is 43.571.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 47.0, "average": 44.0, "min_value": 34.64967533031225, "max_value": 53.35032466968775, "start_time": "2025-03-13T00:00:00", "end_time": "2025-03-14T00:00:00", "id": "37e27a2cbaf8e3050ca1075192127393", "metric_id": "c96c7a1db542d6eaab6eaff549faf7c5", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.9625334218796219, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-13T00:00:00", "bucket_end": "2025-03-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 47.0, "min_metric_value": 34.64967533031225, "max_metric_value": 53.35032466968775, "training_avg": 44.0, "training_stddev": 3.116774889895918, "training_set_size": 8, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 47.000. The average for this metric is 44.000.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 38.0, "average": 43.333333333333336, "min_value": 32.72673161553512, "max_value": 53.93993505113155, "start_time": "2025-03-14T00:00:00", "end_time": "2025-03-15T00:00:00", "id": "ebfaed1849010768c09ea348fa24d506", "metric_id": "b14d91f82cab6c64e40f9828f484e7a2", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.508494466531302, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-14T00:00:00", "bucket_end": "2025-03-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 38.0, "min_metric_value": 32.72673161553512, "max_metric_value": 53.93993505113155, "training_avg": 43.333333333333336, "training_stddev": 3.5355339059327378, "training_set_size": 9, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 38.000. The average for this metric is 43.333.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 41.0, "average": 43.1, "min_value": 32.85792989674451, "max_value": 53.342070103255494, "start_time": "2025-03-15T00:00:00", "end_time": "2025-03-16T00:00:00", "id": "c93c408831b5b2b2c8ebfec82b3df110", "metric_id": "6e3d99cd9e51dbc1f851dbc705430158", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.615110025267013, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-15T00:00:00", "bucket_end": "2025-03-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 41.0, "min_metric_value": 32.85792989674451, "max_metric_value": 53.342070103255494, "training_avg": 43.1, "training_stddev": 3.414023367751831, "training_set_size": 10, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 41.000. The average for this metric is 43.100.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 49.0, "average": 43.63636363636363, "min_value": 32.550746418954894, "max_value": 54.72198085377237, "start_time": "2025-03-16T00:00:00", "end_time": "2025-03-17T00:00:00", "id": "eb0b855fe2c650582d199851dc41d7f4", "metric_id": "ec3f26810b3a239292b1fa2b717b8a4d", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 1.4515122410721617, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-16T00:00:00", "bucket_end": "2025-03-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 49.0, "min_metric_value": 32.550746418954894, "max_metric_value": 54.72198085377237, "training_avg": 43.63636363636363, "training_stddev": 3.6952057391362465, "training_set_size": 11, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 49.000. The average for this metric is 43.636.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 38.0, "average": 43.166666666666664, "min_value": 31.524267663649525, "max_value": 54.809065669683804, "start_time": "2025-03-17T00:00:00", "end_time": "2025-03-18T00:00:00", "id": "af3764f517bd885ce07a1df12018460c", "metric_id": "a606c2ce2ece6fb89d36802640c9db25", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.3313407310626573, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-17T00:00:00", "bucket_end": "2025-03-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 38.0, "min_metric_value": 31.524267663649525, "max_metric_value": 54.809065669683804, "training_avg": 43.166666666666664, "training_stddev": 3.8807996676723806, "training_set_size": 12, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 38.000. The average for this metric is 43.167.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 37.0, "average": 42.69230769230769, "min_value": 30.42132879586577, "max_value": 54.96328658874962, "start_time": "2025-03-18T00:00:00", "end_time": "2025-03-19T00:00:00", "id": "e3b5f47f67563f7e7afaa2c441ff4173", "metric_id": "6ab97b4d901a8fed9a401921dfa08455", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -1.3916512464930308, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-18T00:00:00", "bucket_end": "2025-03-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 37.0, "min_metric_value": 30.42132879586577, "max_metric_value": 54.96328658874962, "training_avg": 42.69230769230769, "training_stddev": 4.090326298813975, "training_set_size": 13, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 37.000. The average for this metric is 42.692.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 39.642857142857146, "min_value": 30.42132879586577, "max_value": 54.96328658874962, "start_time": "2025-03-19T00:00:00", "end_time": "2025-03-20T00:00:00", "id": "9251e330e878f999bddf64fc88faa0f3", "metric_id": "96f3dea60285b712bd754cd759f8901a", "test_execution_id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2025-03-20T08:32:25.504000", "full_table_name": "ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": -3.285010311703607, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-03-19T00:00:00", "bucket_end": "2025-03-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 3.439448281441713, "max_metric_value": 75.84626600427258, "training_avg": 39.642857142857146, "training_stddev": 12.067802953805144, "training_set_size": 14, "training_start": "2025-03-07T00:00:00", "training_end": "2025-03-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 39.643.", "max_bucket_end": "2025-03-20T00:00:00", "is_anomalous": true}], "result_description": "The last row_count value is 0.000. The average for this metric is 39.643."}}]}, "test_results_totals": {"model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 2, "failures": 0}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}}, "test_runs": {"model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.NUMBER_OF_ORDERS.zero_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers", "column_name": "NUMBER_OF_ORDERS", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:25+02:00", "latest_run_time_utc": "2025-03-20T08:32:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_tutorial.elementary.customers", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('zero_count' as varchar)\n          and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as varchar))", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "In column NUMBER_OF_ORDERS, the last zero_count value is 0.000. The average for this metric is 0.222.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('zero_count' as varchar)\n          and upper(column_name) = upper(cast('NUMBER_OF_ORDERS' as varchar))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 4, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-03-19T16:59:19+00:00", "id": "3d43c0e8-4c77-4ea8-a29e-5ea1c5e4f184.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2025-03-19T17:00:52+00:00", "id": "5a747d60-43a5-4384-be7a-22d95c9b6734.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2025-03-19T19:12:28+00:00", "id": "5fc61114-d558-4798-8e2c-c20ffd314d43.test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2025-03-20T08:32:25+00:00", "id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7", "status": "pass", "execution_time": 4.757609844207764}], "description": "There were no failures, no errors and no warnings on the last 4 test runs."}, "median_exec_time": 4.757609844207764, "last_exec_time": 4.757609844207764}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_.3e4565453c.None.row_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:25+02:00", "latest_run_time_utc": "2025-03-20T08:32:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_tutorial.elementary.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)", "test_params": {"model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 14.500.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.CUSTOMERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-03-20T08:32:25+00:00", "id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7", "status": "pass", "execution_time": 4.913954734802246}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}, "median_exec_time": 4.913954734802246, "last_exec_time": 4.913954734802246}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:28+02:00", "latest_run_time_utc": "2025-03-20T08:32:28+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "elementary_tutorial.elementary.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from ELEMENTARY_TUTORIAL.ELEMENTARY__tests.\"test_a5036d4371_elementary_dimension_anomalies_orders_status__anomaly_scores__tmp_20250320083224730804\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    dateadd(day, cast('-2' as integer), cast(max_bucket_end as timestamp))\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from ELEMENTARY_TUTORIAL.ELEMENTARY__tests.\"test_a5036d4371_elementary_dimension_anomalies_orders_status__anomaly_scores__tmp_20250320083224730804\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    dateadd(day, cast('-2' as integer), cast(max_bucket_end as timestamp))\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-03-20T08:32:28+00:00", "id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7", "status": "pass", "execution_time": 4.755640983581543}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}, "median_exec_time": 4.755640983581543, "last_exec_time": 4.755640983581543}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "ELEMENTARY_TUTORIAL", "schema_name": "ELEMENTARY", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2025-03-20T10:32:26+02:00", "latest_run_time_utc": "2025-03-20T08:32:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_tutorial.elementary.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "time_bucket": {"period": "day", "count": 1}, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 39.643.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_TUTORIAL.ELEMENTARY.RETURNED_ORDERS' as varchar)) and\n        metric_name = cast('row_count' as varchar)"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "invocations": [{"affected_rows": null, "time_utc": "2025-03-20T08:32:26+00:00", "id": "c91daf08-06b3-4a1d-871b-5fc3f5ac7de7", "status": "fail", "execution_time": 5.207097053527832}], "description": "There were 1 failures, no errors and no warnings on the last 1 test runs."}, "median_exec_time": 5.207097053527832, "last_exec_time": 5.207097053527832}]}, "test_runs_totals": {"model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 5, "failures": 0}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}}, "coverages": {"model.elementary_tutorial.customers": {"table_tests": 1, "column_tests": 1}, "model.elementary_tutorial.orders": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.returned_orders": {"table_tests": 1, "column_tests": 0}}, "model_runs": [{"unique_id": "model.elementary_tutorial.stg_signups", "schema": "ELEMENTARY", "name": "stg_signups", "status": "success", "last_exec_time": 0.4, "median_exec_time": 0.4, "compiled_code": "-- depends_on: ELEMENTARY_TUTORIAL.ELEMENTARY.signups_validation\n\n\n    with source as (\n        select * from ELEMENTARY_TUTORIAL.ELEMENTARY.signups_training\n    ),\n\n\nrenamed as (\n\n    select\n        id as signup_id,\n        user_id as customer_id,\n        user_email as customer_email,\n        hashed_password,\n        signup_date\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.4}]}, {"unique_id": "model.elementary_tutorial.returned_orders", "schema": "ELEMENTARY", "name": "returned_orders", "status": "success", "last_exec_time": 0.4, "median_exec_time": 0.4, "compiled_code": "\n\nwith orders as (\n    select *\n    from ELEMENTARY_TUTORIAL.ELEMENTARY.orders\n)\n\nselect *\nfrom orders\nwhere status = 'return_pending' or status = 'returned'", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.4}]}, {"unique_id": "model.elementary_tutorial.customers", "schema": "ELEMENTARY", "name": "customers", "status": "success", "last_exec_time": 0.7, "median_exec_time": 0.7, "compiled_code": "with customers as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_customers\n\n),\n\norders as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_orders\n\n),\n\npayments as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_payments\n\n),\n\nsignups as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_signups\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        case\n            when customer_orders.number_of_orders is null then 0\n            else customer_orders.number_of_orders\n        end as number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value,\n        signups.customer_email,\n        \n        signups.signup_date\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n    left join signups\n        on customers.customer_id = signups.customer_id\n\n)\n\nselect * from final", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.7}]}, {"unique_id": "model.elementary_tutorial.stg_payments", "schema": "ELEMENTARY", "name": "stg_payments", "status": "success", "last_exec_time": 0.4, "median_exec_time": 0.4, "compiled_code": "-- depends_on: ELEMENTARY_TUTORIAL.ELEMENTARY.payments_validation\n\n\n    with source as (\n        select * from ELEMENTARY_TUTORIAL.ELEMENTARY.payments_training\n    ),\n\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.4}]}, {"unique_id": "model.elementary_tutorial.orders", "schema": "ELEMENTARY", "name": "orders", "status": "success", "last_exec_time": 0.5, "median_exec_time": 0.5, "compiled_code": "\n\nwith orders as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_orders\n\n),\n\npayments as (\n\n    select * from ELEMENTARY_TUTORIAL.ELEMENTARY.stg_payments\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.5}]}, {"unique_id": "model.elementary_tutorial.stg_customers", "schema": "ELEMENTARY", "name": "stg_customers", "status": "success", "last_exec_time": 0.4, "median_exec_time": 0.4, "compiled_code": "-- depends_on: ELEMENTARY_TUTORIAL.ELEMENTARY.customers_validation\n\n\n    with source as (\n        select * from ELEMENTARY_TUTORIAL.ELEMENTARY.customers_training\n    ),\n\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.4}]}, {"unique_id": "model.elementary_tutorial.stg_orders", "schema": "ELEMENTARY", "name": "stg_orders", "status": "success", "last_exec_time": 0.3, "median_exec_time": 0.3, "compiled_code": "-- depends_on: ELEMENTARY_TUTORIAL.ELEMENTARY.orders_validation\n\n\n    with source as (\n        select * from ELEMENTARY_TUTORIAL.ELEMENTARY.orders_training\n    ),\n\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2025-03-20T08:32:10+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 1}, "runs": [{"id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "time_utc": "2025-03-20T08:32:10+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.3}]}], "model_runs_totals": {"model.elementary_tutorial.stg_signups": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.stg_payments": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.stg_customers": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.stg_orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}}, "filters": {"test_results": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.elementary_tutorial.returned_orders"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.customers", "model.elementary_tutorial.orders"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_signups", "model.elementary_tutorial.stg_customers", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.stg_payments"]}], "test_runs": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.elementary_tutorial.returned_orders"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.customers", "model.elementary_tutorial.orders"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_signups", "model.elementary_tutorial.stg_customers", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.stg_payments"]}], "model_runs": [{"name": "success", "display_name": "Successful Runs", "model_unique_ids": ["model.elementary_tutorial.stg_customers", "model.elementary_tutorial.orders", "model.elementary_tutorial.stg_signups", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.customers", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.returned_orders"]}]}, "lineage": {"nodes": [{"id": "seed.elementary_tutorial.customers_training", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.payments_training", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.signups_training", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.orders_training", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.payments_validation", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.signups_validation", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.customers_validation", "type": "seed", "sub_type": null}, {"id": "seed.elementary_tutorial.orders_validation", "type": "seed", "sub_type": null}, {"id": "model.elementary_tutorial.returned_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_payments", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_signups", "type": "model", "sub_type": "view"}], "edges": [["model.elementary_tutorial.returned_orders", "model.elementary_tutorial.orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_signups"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_customers"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.stg_signups", "seed.elementary_tutorial.signups_training"], ["model.elementary_tutorial.stg_signups", "seed.elementary_tutorial.signups_validation"], ["model.elementary_tutorial.stg_customers", "seed.elementary_tutorial.customers_validation"], ["model.elementary_tutorial.stg_customers", "seed.elementary_tutorial.customers_training"], ["model.elementary_tutorial.stg_orders", "seed.elementary_tutorial.orders_training"], ["model.elementary_tutorial.stg_orders", "seed.elementary_tutorial.orders_validation"], ["model.elementary_tutorial.stg_payments", "seed.elementary_tutorial.payments_training"], ["model.elementary_tutorial.stg_payments", "seed.elementary_tutorial.payments_validation"]]}, "invocations": [{"invocation_id": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "detected_at": null, "command": "run", "selected": "", "full_refresh": false, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}], "resources_latest_invocation": {"model.elementary.dbt_seeds": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_exposures": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.stg_orders": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.test_result_rows": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.stg_signups": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_artifacts_hashes": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_run_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.model_run_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.stg_customers": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.snapshot_run_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_columns": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_models": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_snapshots": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.alerts_schema_changes": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_source_freshness_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.alerts_dbt_tests": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.schema_columns_snapshot": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.elementary_test_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.monitors_runs": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.stg_payments": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.metadata": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_invocations": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.data_monitoring_metrics": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_tests": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_metrics": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.orders": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.alerts_anomaly_detection": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.anomaly_threshold_sensitivity": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.seed_run_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.returned_orders": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.alerts_dbt_models": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary_tutorial.customers": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.metrics_anomaly_score": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.alerts_dbt_source_freshness": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.job_run_results": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0", "model.elementary.dbt_sources": "ed5ef7ba-e05f-43bb-ba53-c68c685692b0"}, "invocations_job_identification": {}, "env": {"project_name": "elementary_tutorial", "env": "dev", "warehouse_type": "snowflake"}, "tracking": {"posthog_api_key": "phc_56XBEzZmh02mGkadqLiYW51eECyYKWPyecVwkGdGUfg", "report_generator_anonymous_user_id": "8be5a81d-2948-46fa-a137-85f51c19768b", "anonymous_warehouse_id": "46d1a54432dccfa0b6d886926084b6e3ebc55ab4963190cda24114b6ae75d540"}}